//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: build/src/main/java/com/adiron/busme/platform/MasterMessagesRequestProcessor.java
//
//  Created by polar on 5/25/13.
//

#import "IOSClass.h"
#import "com/adiron/busme/api/APIBase.h"
#import "com/adiron/busme/api/MasterMessage.h"
#import "com/adiron/busme/integration/http/NameValuePair.h"
#import "com/adiron/busme/integration/http/message/BasicNameValuePair.h"
#import "com/adiron/busme/platform/Log.h"
#import "com/adiron/busme/platform/MasterMessageBasket.h"
#import "com/adiron/busme/platform/MasterMessagesRequestProcessor.h"
#import "java/util/ArrayList.h"
#import "java/util/Collection.h"
#import "java/util/HashMap.h"
#import "java/util/Iterator.h"
#import "java/util/List.h"
#import "java/util/Map.h"

@implementation ComAdironBusmePlatformMasterMessagesRequestProcessor

static NSString * ComAdironBusmePlatformMasterMessagesRequestProcessor_LOGTAG_;

- (ComAdironBusmePlatformMasterMessageBasket *)messageBasket {
  return messageBasket_;
}
- (void)setMessageBasket:(ComAdironBusmePlatformMasterMessageBasket *)messageBasket {
  JreOperatorRetainedAssign(&messageBasket_, messageBasket);
}
@synthesize messageBasket = messageBasket_;
- (id<ComAdironBusmePlatformMasterMessagesRequestProcessor_OnMasterMessagesResponseListener>)onMasterMessagesResponseListener {
  return onMasterMessagesResponseListener_;
}
- (void)setOnMasterMessagesResponseListener:(id<ComAdironBusmePlatformMasterMessagesRequestProcessor_OnMasterMessagesResponseListener>)onMasterMessagesResponseListener {
  JreOperatorRetainedAssign(&onMasterMessagesResponseListener_, onMasterMessagesResponseListener);
}
@synthesize onMasterMessagesResponseListener = onMasterMessagesResponseListener_;

+ (NSString *)LOGTAG {
  return ComAdironBusmePlatformMasterMessagesRequestProcessor_LOGTAG_;
}

- (id)initWithComAdironBusmePlatformMasterMessageBasket:(ComAdironBusmePlatformMasterMessageBasket *)messageBasket
withComAdironBusmePlatformMasterMessagesRequestProcessor_OnMasterMessagesResponseListener:(id<ComAdironBusmePlatformMasterMessagesRequestProcessor_OnMasterMessagesResponseListener>)onMasterMessagesResponseListener {
  if ((self = [super init])) {
    [self setMessageBasketWithComAdironBusmePlatformMasterMessageBasket:messageBasket];
    [self setOnMasterMessagesResponseListenerWithComAdironBusmePlatformMasterMessagesRequestProcessor_OnMasterMessagesResponseListener:onMasterMessagesResponseListener];
  }
  return self;
}

- (ComAdironBusmePlatformMasterMessageBasket *)getMessageBasket {
  return messageBasket_;
}

- (void)setMessageBasketWithComAdironBusmePlatformMasterMessageBasket:(ComAdironBusmePlatformMasterMessageBasket *)messageBasket {
  self.messageBasket = messageBasket;
}

- (id<ComAdironBusmePlatformMasterMessagesRequestProcessor_OnMasterMessagesResponseListener>)getOnMasterMessagesResponseListener {
  return onMasterMessagesResponseListener_;
}

- (void)setOnMasterMessagesResponseListenerWithComAdironBusmePlatformMasterMessagesRequestProcessor_OnMasterMessagesResponseListener:(id<ComAdironBusmePlatformMasterMessagesRequestProcessor_OnMasterMessagesResponseListener>)onMasterMessagesResponseListener {
  self.onMasterMessagesResponseListener = onMasterMessagesResponseListener;
}

- (void)processResponseWithComAdironBusmeApiAPIBase_Tag:(ComAdironBusmeApiAPIBase_Tag *)response {
  id<JavaUtilMap> messages = nil;
  if (response != nil && ((ComAdironBusmeApiAPIBase_Tag *) NIL_CHK(response)).childNodes != nil) {
    {
      id<JavaUtilIterator> iter__ = ((id<JavaUtilIterator>) [((id<JavaUtilList>) NIL_CHK(response.childNodes)) iterator]);
      while ([((id<JavaUtilIterator>) NIL_CHK(iter__)) hasNext]) {
        ComAdironBusmeApiAPIBase_Tag *tag = ((ComAdironBusmeApiAPIBase_Tag *) [((id<JavaUtilIterator>) NIL_CHK(iter__)) next]);
        if ([@"Messages" isEqual:((ComAdironBusmeApiAPIBase_Tag *) NIL_CHK(tag)).name]) {
          [ComAdironBusmePlatformLog dWithNSString:ComAdironBusmePlatformMasterMessagesRequestProcessor_LOGTAG_ withNSString:[NSString stringWithFormat:@"getMessagesXML: GOT %d Elements", [((id<JavaUtilList>) NIL_CHK(tag.childNodes)) size]]];
          messages = [[[JavaUtilHashMap alloc] initWithInt:[((id<JavaUtilList>) NIL_CHK(tag.childNodes)) size]] autorelease];
          if ([((id<JavaUtilList>) NIL_CHK(tag.childNodes)) size] > 0) {
            [ComAdironBusmePlatformLog dWithNSString:ComAdironBusmePlatformMasterMessagesRequestProcessor_LOGTAG_ withNSString:[NSString stringWithFormat:@"getMessagesXML: GOT markers %@", tag]];
            [ComAdironBusmePlatformLog dWithNSString:ComAdironBusmePlatformMasterMessagesRequestProcessor_LOGTAG_ withNSString:[NSString stringWithFormat:@"getMessagesXML: GOT %d Markers", [((id<JavaUtilList>) NIL_CHK(tag.childNodes)) size]]];
            {
              id<JavaUtilIterator> iter__ = ((id<JavaUtilIterator>) [((id<JavaUtilList>) NIL_CHK(tag.childNodes)) iterator]);
              while ([((id<JavaUtilIterator>) NIL_CHK(iter__)) hasNext]) {
                ComAdironBusmeApiAPIBase_Tag *n = ((ComAdironBusmeApiAPIBase_Tag *) [((id<JavaUtilIterator>) NIL_CHK(iter__)) next]);
                if ([@"Message" isEqual:((ComAdironBusmeApiAPIBase_Tag *) NIL_CHK(n)).name]) {
                  NSString *id_ = ((NSString *) [((id<JavaUtilMap>) NIL_CHK(n.attributes)) getWithId:@"id"]);
                  if (((NSString *) [((id<JavaUtilMap>) NIL_CHK(n.attributes)) getWithId:@"destroy"]) != nil) {
                    [((id<JavaUtilMap>) NIL_CHK(messages)) putWithId:id_ withId:nil];
                  }
                  else {
                    ComAdironBusmeApiMasterMessage *msg = [[[ComAdironBusmeApiMasterMessage alloc] init] autorelease];
                    [((ComAdironBusmeApiMasterMessage *) NIL_CHK(msg)) loadParsedXMLWithComAdironBusmeApiAPIBase_Tag:n];
                    [((id<JavaUtilMap>) NIL_CHK(messages)) putWithId:[((ComAdironBusmeApiMasterMessage *) NIL_CHK(msg)) getId] withId:msg];
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  if (messages != nil) {
    [((id<ComAdironBusmePlatformMasterMessagesRequestProcessor_OnMasterMessagesResponseListener>) [self getOnMasterMessagesResponseListener]) onResponseWithJavaUtilMap:messages];
  }
}

- (id<JavaUtilList>)getArguments {
  ComAdironBusmePlatformMasterMessageBasket *basket = [self getMessageBasket];
  if (basket != nil) {
    id<JavaUtilCollection> collection = [((ComAdironBusmePlatformMasterMessageBasket *) NIL_CHK(messageBasket_)) getMessages];
    id<JavaUtilList> params = [[[JavaUtilArrayList alloc] initWithInt:[((id<JavaUtilCollection>) NIL_CHK(collection)) size]] autorelease];
    {
      id<JavaUtilIterator> iter__ = ((id<JavaUtilIterator>) [((id<JavaUtilCollection>) NIL_CHK(collection)) iterator]);
      while ([((id<JavaUtilIterator>) NIL_CHK(iter__)) hasNext]) {
        ComAdironBusmeApiMasterMessage *j = ((ComAdironBusmeApiMasterMessage *) [((id<JavaUtilIterator>) NIL_CHK(iter__)) next]);
        if (![((ComAdironBusmeApiMasterMessage *) NIL_CHK(j)) isSeen]) {
          [((id<JavaUtilList>) NIL_CHK(params)) addWithId:[[[ComAdironBusmeIntegrationHttpMessageBasicNameValuePair alloc] initWithNSString:@"message_ids[]" withNSString:[((ComAdironBusmeApiMasterMessage *) NIL_CHK(j)) getId]] autorelease]];
          [((id<JavaUtilList>) NIL_CHK(params)) addWithId:[[[ComAdironBusmeIntegrationHttpMessageBasicNameValuePair alloc] initWithNSString:@"message_versions[]" withNSString:[NSString stringWithFormat:@"%qi", [((ComAdironBusmeApiMasterMessage *) NIL_CHK(j)) getVersion]]] autorelease]];
        }
      }
    }
    return params;
  }
  else {
    return nil;
  }
}

+ (void)initialize {
  if (self == [ComAdironBusmePlatformMasterMessagesRequestProcessor class]) {
    JreOperatorRetainedAssign(&ComAdironBusmePlatformMasterMessagesRequestProcessor_LOGTAG_, [[IOSClass classWithClass:[ComAdironBusmePlatformMasterMessagesRequestProcessor class]] getName]);
  }
}

- (void)dealloc {
  JreOperatorRetainedAssign(&onMasterMessagesResponseListener_, nil);
  JreOperatorRetainedAssign(&messageBasket_, nil);
  [super dealloc];
}

- (void)copyAllPropertiesTo:(id)copy {
  [super copyAllPropertiesTo:copy];
  ComAdironBusmePlatformMasterMessagesRequestProcessor *typedCopy = (ComAdironBusmePlatformMasterMessagesRequestProcessor *) copy;
  typedCopy.messageBasket = messageBasket_;
  typedCopy.onMasterMessagesResponseListener = onMasterMessagesResponseListener_;
}

@end
